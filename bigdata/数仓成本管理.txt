3 成本管理
3.1 问题分析
随着数据资产得以不断积累，成本陷阱的隐患也在不断积累。数据和计算任务的不断增多，以下问题也逐渐显现出来：

设备成本急剧上升

维护成本越来越大

数据之间的关系变得复杂

数据模型的复用性降低

造成些成本陷阱的原因其实也不复杂，主要有以下几类：

数据上线容易下线难

数据价值与资源消耗不匹配

缺少对数据成本的量化管理

没有成本管理，几乎没有人去关注数据剩余的生命周期，即使知道有些数据表已经很少有人使用也不知道是否该下线，更不敢随意下线。

如果任由数据这样的野蛮增长，带给我们的数据成本将日趋高昂。

3.2 成本与价值量化
表的价值一般体现在用户对报表的访问热度以及所支持的业务，我们可以利用这种计算方式直接评估应用层报表的实用价值。

那对于数据仓库中数量更多的中间表和底层表我们该如何计算它们的价值呢？这里我们可以基于数据血缘，将应用层报表的直接价值逐层传递到上游表上叠加计算。



以上图为例，终端报表的价值可以直接由其访问记录的加权值计算得出。

为了说明具体的计算方法，我们不妨在划分表的价值给上游表时简单地使用均等划分，那么具体的计算公式如下:



成本则主要由产出该表的计算任务所消耗的计算资源成本和该表数据的存储成本组成。

表的价值计算类似，表的成本计算也是根据数据血缘来进行叠加计算的。不过表的成本的计算顺序与价值计算正好相反，具体计算公式如下:



3.3 成本优化
有了表的价值与成本的量化指标之后，我们就可以计算出每个数据表的投入产出比了。即时对数据仓库的数据进行详细的评估，及时发现成本问题。比如：

僵尸报表和任务；

低价值高成本的数据表；

计算高峰期高消耗的任务。

当我们发现有产出价值几乎为零的数据表时，我们就应该重点关注该数据表和相应的计算任务是否又继续存在的必要。

在谨慎评估的前提下，我们要对无用的报表的任务依照自下而上的原则逐步下线这些僵尸报表和任务。

对于低价值高成本的数据表，我们也要组织人力对相关的数据和业务进行重新评估，看看是否有数据整合和优化的空间。
